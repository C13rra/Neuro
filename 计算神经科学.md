# 写在前面

## 为什么写这个东西？

笔者写这篇文章的时候刚刚高考结束完一个月，未来决定学习计算神经科学。我想要尽早参与神经科学的科研学习，但同时我的基础课也都没有学完。

我之前有个想法是一定要打好基础才能去进行下一步的学习，而这个所谓的 **打好基础** 到底到什么度为止，其实我并没有怎么想过，只是觉得学得越深越好越多越好，结果却做了很多的无用功。<sub>这也是我的高中老师和竞赛教练一直有的想法。</sub>

面对这个难题，Philip Nelson 的《生物物理学：能量、信息、生命》中的引言很启发我：

> 我认识到本科教育使我到大学最后一年（甚至更晚）才能接触到大量基本概念……尚未获得全貌，人们就开始小心翼翼地建造复杂的数学大厦……很多本科生在第一年就开始做研究，他们需要及早知道概况。

PiKaChu345 的[视频](https://www.bilibili.com/video/BV1qb421n7qK/?spm_id_from=333.999.0.0&vd_source=8acc004888d1e147ebe6458188771c23)也在这个问题上启发了我：

> 认为要多读书的人往往认为**只有**到达前沿**才能**开始研究。他们潜意识里认为在到达前沿之前所有的问题都已经被人们解决了；只要到达前沿，自动学会研究。不管之前有没有受过做研究的教育。
>
> 认为要多做题的人往往认为要做大量的题目，打好坚持的基础。他们潜意识里认为**只要**自己的基础足够数量，**就**可以做出好的研究。
>
> 所以为什么不能像做研究一样学习知识呢？

同时我也越来越意识到发现问题的重要性。之前的高中同学有几个总是能提出具有启发性的问题，这让我非常佩服。

我希望写这样一篇文章——能让没有基础的人们尽可能轻松地阅读，同时以研究感兴趣的问题作为文章的主线，而不是处处按照教材的顺序。

这篇文章是我边学边写的，势必会有很多问题和错误。但随着之后的学习，这些前面的问题和错误会被修正。也希望能吸引更多的人们来学习或指点。

我希望那个花费大约 100 个小时来写作这篇文章，在每周的周日更新写两个小时。今天是 2024-07-08，不出意外的话，明年的今天就可以完成这篇文章了。

## 从高中开始

我们先来复习一下高中学过的知识：

1. 静息电位和动作电位
2. 微分和积分
3. 处理 RLC 电路
### 静息电位和动作电位

> [!NOTE] 回顾
>
> - 静息电位的时候 $K^+$ 外流，外正内负。膜电位大约为 $-65\rm mV$.
> - 动作电位的时候 $Na^+$ 内流，外负内正。膜电位大约为 $40\rm mV$.[^1]
>   <img src="C:\Users\c13rr\AppData\Roaming\Typora\typora-user-images\image-20240729014806191.png" alt="image-20240729014806191" style="zoom:50%;" />

- 外流离子的种类改变源于 **离子电导** $G_{Na}+,G_{K^+}$ 的改变。
- 离子电导主要是由**离子通道**决定的，离子的跨膜转运通过离子通道和载体蛋白。而离子通道的开放取决于外力、电压、配体等刺激，因其结构而异。
- **主动运输**使膜内外的离子浓度不同。
- 某一离子的**平衡电位**非 $0$,是因为膜内外的离子浓度不同。当达到平衡电位的时候，扩散导致的离子移动和电位导致的离子移动相互抵消。这种机制也导致了**静息电位**的产生。
- **动作电位**的**产生**是因为电压门控 $\rm Na^+$ 离子通道的开放程度随膜电位的上升而增大。从而形成了正反馈。当膜电位高于阈值的时候，将会产生**动作电位**。
- 兴奋处升高的膜电位产生了轴向的电流，使得相邻处的膜电位随之升高，实现了**动作电位**的**传导**。

### 微分、积分和微分方程

### RLC 电路


> [!faq] 我们现在可以问出的问题：
>
> 1. 直观的看，$V_m$ 的改变来自于 $G_K$、$G_{Na}$ 等**离子电导**的改变。不过电位到底为什么改变？离子电导由什么来决定？又因为什么而产生变化？我们能不能得知这些变化可能是什么形式的？
> 2. 在**静息电位**的时候，细胞显然是处于一个**有别于外界的稳态**之中——$V_m$ 稳定在大约 $-70\rm mV$ 左右而不是 $0$。这是由什么导致的呢？
> 3. **动作电位** 是如何产生的？又是如何 **传导** 的？我们都知道 **髓鞘** 的产生让有颌类脊椎动物的神经传导速度大大加快了，这是如何做到的？乌贼没有髓鞘也能快速地传导兴奋，但它的轴突显著的粗，轴突的物理特征会怎么样影响动作电位的传导？

## 什么是计算神经科学？

> [!FAQ] 什么是计算神经科学？
>
> 1. 计算神经科学在研究什么问题？
> 2. 计算神经科学有哪些研究成果？

为了回答这个问题，我们先来看看：

1. 计算神经科学的教材的大纲
2. 其他学校的课程大纲
3. 新的论文和研究成果

### 教材的大纲

### 其他学校的课程大纲

### 几个论文

# 孤立等势的细胞

## 静息电位：电化学平衡[^2][^3]

静息电位的产生源自于 **扩散** 和 **电场力作用下运动** 的平衡——或者说 **电化学平衡**。

这需要一些简单的物理知识，但毕竟这并不是生物物理学，所以我们并不需要细究背后的物理学机制。我们就尽量快的过去了，推导的细节详见《生物物理学：能量、信息、生命》$\S 4,7.4,11.1$和《费曼物理学讲义》$\S39,40,41,43,44$。

1. **扩散**：我们在高中学过**扩散**的本质是**无规行走**。那么如何定量地描述无规行走？又如何定量地描述扩散(**Fick 定律**)？
2. **摩擦耗散**与**迁移**：真空中受到恒定外力*(马上我们会见到的：**电力**!)*的物体会做匀加速运动；但在分散系中不是这样：假设只有一种“特殊”的分散质收到恒定的外力，它和分散剂的碰撞会让它原有的速度损失。因此，它会服从不同的运动规律。
3. 然后我们将会介绍一些**统计物理学**的基本知识 和 **Einstein 关系**。前者告诉我们给定能量下粒子的分布(**Bolzmann 分布**)，粒子的速度，还给了我们衡量一个事件在微观世界发生可能的尺度($kT$)；后者把**扩散**和**迁移**联系在一起。它们背后的物理很有意思，但不是我们想要讨论的重点。
4. **电化学平衡**：把扩散和迁移联系在一起以后，我们就可以讨论一种离子的动态了(这叫做 **Nernst-Planck 方程**)。把多种离子的动态放在一起考虑，保证总电流为 0，我们就可以计算出静息电位的值了(这叫做 **弦电导方程** 和 **GHK 方程**)
5. 令人感叹的是，计算细胞的静息电位并不需要知道细胞的电学常数的绝对大小(膜电阻、膜电容)。我们会在下一节讨论它们。

### 扩散：无规行走

不妨假设 $L$ 是服从在 $(-1,1)$ 上均匀分布的随机变量。那么有
$$
E[L]=0,E[L^2]=\int_{-1}^{1}x^2{\rm d}x=1/3
$$
记 $x_n$ 为 $n$ 个 $L$ 的总和，那么有：
$$
E[x_n]=0,E[x_n^2]=E[x_{n-1}^2]+2E[x_{n-1}L]+E[L^2]
$$
解得
$$
E[x_n^2]=nE[L^2]=n/3
$$
令 n = 10,求 1000000 次 $x_n^2$ 取平均值：
```Python
from random import *

ans = 0
for i in range(1,1000001,1):
    a = 0
    for j in range(1,11,1):
        b = 2 * random()-1
        a += b
    ans += a**2/1000000
print(ans)

```
得到的结果几乎总能保证前三位是 3.33。算是验证了我们的结论。这样我们就得到了 $x^2$ 与 $n,t$ 的线性关系。
> [!IMPORTANT] 无规行走的结论
>
> 对于 $n$ 维无规行走的任意一个运动方向：
>
> $$
> E[x(t)^2]=2Dt
> $$
>
> 其中 $D$ 是扩散系数。三维的无规行走：
>
> $$
> E[r(t)^2]=6Dt
> $$

> [!Inote] **扩散的速度**：
>
> - 对于室温下水中的小分子
>
>   $$
>   D\approx 10^{-9}{\rm m^2 s^{-1}}=1{\rm \mu m^2ms^{-1}}
>   $$
>
> - 在半径为 $1{\rm \mu m}$ 的细菌内，小分子从中心均匀扩散到整个细胞的用时大概只需要 $0.2 {\rm ms}$。可见扩散在亚细胞/细胞层面上是非常迅速的。
>
> - 不过随着尺度的增大，扩散的速度将会显著变慢。有的神经元轴突长达 $\rm 1m$，小分子均匀地扩散 $\rm 1m$ 大概需要整整 $16$ 年才行。

### 粘性摩擦系数/迁移率：溶液的摩擦耗散和电场力下运动

> [!FAQ] 摩擦是什么？
>
> Gilbert：好的。你说过，由于热运动，处于室温的气体不会落到地板上。那么，它们为什么不会因为摩擦而减速并最终停止（然后落向地板）呢？
> Sullivan：啊，那不可能，因为能量是守恒的。所有气体分子之间仅发生弹性碰撞，就像一年级物理课中学过的弹球那样。
> Gilbert：哦？那什么是摩擦呢？如果在比萨斜塔上丢下两个球，由于摩擦，轻的会落得慢一些。所有人都知道机械能并不守恒它最终转化为热能。
> Sullivan：哦，嗯….
> 你看，一知半解对于两位虚拟的科学家来说真是件危险的事。假如不是扔一个小球，而是把一个气体分子以极大速度射进房间，比如 100 倍于平均速度（确实可以用粒子加速器做到这一点），会发生什么呢？
>
> （摘自《生物物理学：能量、信息、生命》$\S3.2$ [^2]）

这里的 **摩擦** 并不是来自于阻力 $f$ 。**粘性摩擦耗散**源于“特殊”分子和周围热运动的“背景”分子的随机碰撞。随机碰撞的摩擦耗散的结果是粒子在每次碰撞之后丢失它“前进”的动量：丢失一定比例甚至全部丢失。

关于这一点，_《费曼物理学讲义》$\S 43$_ [^3] 的说明非常形象：

> 作为非平衡状态的一个简单例子，我们来考虑气体中离子的扩散。假设在气体中存在着浓度相当小的离子——即带电分子。如果在气体上施加一个电场，则每个离子将受到一个力，这个力不同于气体中的中性分子所受的力。
>
> 假设没有其他分子存在，直至到达容器壁前，离子都有一个**恒定加速度**。**但是**，由于存在着其他分子，它**不能这样**，它的速度只在和其他分子**发生碰撞并失去动量以前增加**。此后再次增加速率，它又会再次失去动量。
>
> 净结果是，这个离子沿着一条奇特的路径运动，但是**净运动**总是沿着电力的方向。我们将看到离子在作一种**平均速率正比于电场的平均"漂移"**，电场越强，离子跑得越快。
>
> 当加上电场，并且离子沿着电场方向运动时——当然这不是处在热平衡状态，而是力图趋向于平衡——离子位于容器的终端。利用分子动理论，我们可以计算漂移速度。

关于粘性摩擦系数/迁移率的推导，详见*《费曼物理学讲义》*$\S 43.3$[^3]。在这里费曼先假设每次碰撞之后“特殊”分子**完全丢失**其“前进”的动量:

$$
v_{drift}=\frac{F\tau}{m}
$$

最后得到 **粘性摩擦系数** $\zeta$ ：

$$
\zeta = \frac{m}{\tau}
$$

其中 $\tau$ 是 **平均碰撞时间**。事实上每次碰撞之后“特殊分子”并不会完全丢失其“前进”的动量。即使假设丢失其一定比例的“前进”动量，也可以同样得到 $v$ 和 $F$ 的线性关系。

> [!WARNING] 平均速度与平均末速度
>
> 一个典型的看起来合理但却典型的**错误**是：
>
> $$
> v'_{drift}=\frac{\frac{F}{2m}\tau^2}{\tau}=\frac{F\tau}{2m}
> $$
>
> 算出来错误的粘性摩擦系数：
>
> $$
> \zeta = \frac{2m}{\tau}
> $$
>
> 许多教科书上都出现了这个错误。在 _《生物物理学：能量、信息、生命》$\S 4.1.4.$_[^2] 中也出现了这个错误。错误的原因则在于 **平均末速度** 和 **平均速度** 的联系并不是简单的。详见 _《费曼物理学讲义》_ $\S 44.3$[^3]。

而其中 $m$，$\Delta t$ 都是粒子本身的特性。而和 $F$ 无关。因此可以设 $\zeta$ 为**粘性摩擦系数**/在有的地方也记 $\mu$ 为**迁移率**/或者 $\mu'$ 为**电迁移率**：

$$
v_{drift}=\frac{F}{\zeta}=\mu F=\mu'qF
$$

> [!NOTE] Stokes 定律
>
> **Stokes 定律**给出了在低雷诺数流体中，球形物体的粘性摩擦系数 $\zeta$：
>
> $$
> \zeta=6\pi\eta R
> $$
>
> 其中 $\eta$ 是溶液的粘度。

### 统计物理学的基本知识

#### 给定能量下分子的分布

> [!IMPORTANT] 玻尔兹曼分布/正则系综：
>
> $$
> n=(常数)\exp(-\frac{P.E.}{k T})
> $$

- 它们的速度如何？

  如果温度不变，外力并不会改变分子的速度分布。

  $$
  n_{>u}\propto \exp(-\frac{K.E.}{kT})
  $$

  $$
  f(v_x,v_y,v_z){\rm d}x{\rm d}y{\rm d}z \propto \exp(-\frac{m(v_x^2+v_y^2+v_z^2)}{2kT}){\rm d}x{\rm d}y{\rm d}z
  $$

### Einstein 关系

关于 Einstein 关系的推导会用到以上的 1.2.1,1.2.2,1.2.3。推导的过程详见 《费曼物理学讲义》$\S 43.5$。值得一提的是 Einstein 关系是一类[涨落-耗散定理](https://en.wikipedia.org/wiki/Fluctuation-dissipation_theorem)。

> [!IMPORTANT] Einstein 关系：
>
> $$
> D=\frac{kT}{\zeta}=\mu kT
> $$

### Fick 定律

> [!IMPORTANT] Fick 定律
>
> $$
> j=-D\frac{{\rm d}c}{{\rm d}x}
> $$
>
> $$
> \frac{{\rm d}c}{{\rm d}t}=-D\frac{{\rm d^2}c}{{\rm d} x^2}
> $$

### Nernst Planck 方程

> [!IMPORTANT] Nernst-Planck 方程
>
> $$
> j=D(\frac{qEc}{kT}-\frac{{\rm d}c}{{\rm d}x})=-\mu kT\frac{{\rm d}c}{{\rm d}x}-\mu qc\frac{{\rm d}V}{{\rm d}x}
> $$
>
> 在 _《神经科学的数学基础》_[^8] 用到的是 **电迁移率** $\mu$ / 摩尔迁移率 $u=\frac{\mu'}{N_A}$：
>
> $$
> j=-\frac{\mu' kT}{q}\frac{\partial c}{\partial x}-\mu' z c \frac{\partial V}{\partial x}
> $$

在 Nernst-Planck 方程中令 $j=0$，可以推导出 Nernst 电位也即平衡电位。Nernst 电位是只针对一种离子而言的，当这种离子在两侧通量平衡时，就达到了 Nernst 电位。

> [!IMPORTANT] **Nernst 电位**也即平衡电位：
>
> $$
> V_{eq}=(V_{in}-V_{out})=-\frac{kT}{q}\ln \frac{c_{in}}{c_{out}}=-\frac{RT}{zF}\ln\frac{c_{in}}{c_{out}}
> $$

> [!Warning] Nernst 电位是针对**一种**离子而言的。

> [!faq] 为什么细胞内外的离子浓度不同？
> Contents

### GHK 方程和弦电导方程

要推导出静息电位，必须要考虑多种离子才行。还要考虑的是一些膜物理学的细节。这里唯一的不同在于**分配系数** $\beta$ 描述的膜内离子浓度和紧邻溶液处的离子浓度呈一定的比例。

> [!IMPORTANT] GHK 方程
>
> 恒定场方程 CFE:
>
> $$
> i=\frac{\beta F uz^2V_m(c_{out}\exp({\frac{zFV_m}{RT}})-c_{in})}{\exp(\frac{zFV_m}{RT})-1}=PzF\xi[\frac{c_{out}\exp(-\xi)-c_{in}}{\exp(-\xi)-1}]
> $$
>
> 其中 $\beta$ 是分配系数，$P$ 是渗透率。
>
> 令各种离子电流的代数和为 $0$，我们就可以求解静息电位，这被称为 Goldman-Hodgkin-Katz 方程：
>
> $$
> V_M=\frac{RT}{F}\ln\frac{P_K[K^+]_{out}+P_{Na}[Na^+]_{out}+P_{Cl}[Cl^-]_{in}}{P_K[K^+]_{in}+P_{Na}[Na^+]_{in}+P_{Cl}[Cl^-]_{out}}
> $$

又或者用电导的方式表示，这样得到的方程更加简洁，这被称为弦电导方程：

> [!IMPORTANT] 弦电导方程
>
> $$
> V_M=\frac{g_KE_K+g_{Na}E_{Na}+g_{Cl}E_{Cl}}{g_{K}+g_{Na}+g_{Cl}}
> $$

## 细胞的被动电学性质

1. **归一化**——我们希望得到的膜的电学量仅仅和膜的组成有关，而尽量不要和其面积大小有关。
2. **膜时间常数**——**处处等势**的单个神经元，外加电流下，其电位如何随时间改变

在下一章中我们还要研究不处处等势的细胞：

1. **空间常数**和**电缆方程**——电兴奋在轴突上的衰减传播，**并不处处等势**。
2. **树突**和**电缆方程的解**——考虑具有几何结构的电缆：粗细的不同；分支和等效柱体，孤立接合点。

### 膜电学量的归一化

我们希望得到的膜的电学量仅仅和膜的组成有关，而尽量不要和其面积大小有关。因为生物膜的组成和厚度在一定范围内是不变的。

整个膜的电阻可以看作多个电阻的并联，整个膜的电容也可以看作多个电容的并联。假定膜上电容和电阻的密度不变，那么 $n$ 和膜的面积 $S$ 成正比。

高中我们学过 $n$ 个电阻的并联得到的总电阻

$$
R\propto \frac{1}{n} \propto \frac{1}{S}
$$

$n$ 个电容并联得到的总电容

$$
C\propto n \propto S
$$

> [!IMPORTANT] 膜电阻、膜电容、膜电流的归一化
>
> 归一化得到的膜电阻、膜电容、膜电流就分别是
>
> $$
> r_M=RS,\ c_M=\frac{C}{S},\ i_M=\frac{I}{S}
> $$

### 一些事实

#### 电流和为 $0$

> [!faq] 电流和为什么必须是 $0$？换句话说，为什么细胞一定是电中性的？
>
> 我们在高中的时候经常听老师说宏观物体都是电中性的，让我们来假想一下如果不是这样会发生什么——一个小细胞的半径大概为 $R=10\rm \mu m$,假定里面全都是水分子，让我们看看从其中 0.01% 的水分子里移走一个电子会发生什么。

被移走电子的水分子因为相互排斥将会迁移到水滴的表面，形成一个半径为 R 的带电球壳。这样一个带电球壳的静电势能将是

$$
P.E.=\frac{1}{2}QV=\frac{Q^2}{8\pi \epsilon_0 R}=2.249×10^{-3}{\rm J}
$$

单一带电水分子的静电势能为

$$
p.e.=\frac{eQ}{8\pi \epsilon_0 R}=1.611×10^{-13}{\rm J}
$$

根据 1.3.的玻尔兹曼分布：

$$
\frac{P(发生这件事)}{P(啥也不发生)}=\exp(\frac{-P.E.}{kT})= 1×10^{-16895524}
$$

可见这是完全不可能发生的事情。

#### 膜电位的改变基本不会影响离子浓度

> [!faq] 膜电位改变需要多少离子？
> 
> 假设细胞的半径为 $R=10\rm \mu m$，膜电容为 $c_M=1\rm \mu F/cm^2$，动作电位峰值和静息电位的电位差大约为 $\Delta V_M=100\rm mV$。
> 假设细胞内离子总数为 $n_1$, 使膜电位改变 $\Delta V_M$ 所需要的离子总数为 $n_2$。比较 $n_1,n_2$。

可以求出
$$
n_2 = c_M \Delta V_M (4\pi R^2)/(e×{\rm N_A})=1.30241×10^{-17}{\rm mol}
$$
一个实际的哺乳动物细胞的离子浓度为：

|     | $K^+$ | $Na^+$ |
| --- | ----- | ------ |
| 细胞内 | 140mM | 10mM   |
| 细胞外 | 5mM   | 145mM  |
不妨取 $c = 5\rm mM$:
$$
n_1 = cV=c(4\pi R^3/3)=2.0944×10^{-14}{\rm mol}
$$
得到的
$$
n_2/n_1 = 0.000621856
$$
可见膜电位的改变基本不会影响膜内外的离子浓度，因此各种离子的平衡电位在不是很长的时间内可以视作不变。
### 膜时间常数 / 求解线性常系数微分方程

#### RC 电路

1. 我们在高中学过，**稳定电路**的电容可以当作断路。所以考虑等效电路的**稳态解**时，我们可以完全不去考虑电容。
2. 如果我们需要考虑电路的**动态**(显然是达到稳态前)：通过对$$Q=CU$$求导并归一化，我们得到：$$i_{cap}=c_M\frac{{\rm d}V_M}{{\rm d}t}$$

#### 三个电流和其对应的微分方程

细胞有 3 个电流:

1. 膜电容阻碍膜电位变化： $-i_{cap}$
2. 外加电流 $i_M$
3. 漏电流也在阻碍膜电位的变化： $-V_M/r_M$：
   1. 一方面我们以静息电位为 $V_r=0$，而不是细胞外基质。实际上相对于细胞外基质，$V_r=-65\rm mV$ 左右。
   2. 另一方面我们假定 $r_M$ 恒定并不随膜电位变化。尽管实际上 $r_M$ 是 $V,t$ 的函数，也就是 $r_M=r_M(V,t)$
   3. 这样的假设有没有道理呢？根据弦电导方程可以计算，这样的假设的确成立。

把三个电流加起来，我们就得到了

> [!NOTE] 膜电位的微分方程
>
> $$
> c_M\frac{{\rm d}V_M(t)}{{\rm d}t}=-\frac{V_M}{r_M}+i_M
> $$

#### 求解之前

即使不会解这个微分方程，也可以想到当时间足够长时达到稳态，$V_M$ 应该不再随着时间变化。

> [!IMPORTANT] 一阶系统的稳态解
>
> 所有量关于时间的导数为 $0$.

这里最多只出现了一阶导数，因为直线上的流是不会振动的，所以系统最终会趋于一个稳定不动点或者无穷远处。关于这个主题我们会在后面进一步阐述。

因此左边为 $0$，得到最终稳态的电压为

$$
V_{ss}=i_Mr_M
$$

> [!IMPORTANT] 输入电阻
>
> 定义为当恒定电流 $i_M$ 注入细胞内时的稳态电压 / 输入电流：
>
> $$
> r_{inp}=\frac{V_{ss}}{i_M}=r_M
> $$

#### 求解一阶线性常微分方程

> [!faq] 求解一阶线性常微分方程
>
> $$
> y'(x)+p(x)y=q(x)
> $$

积分因子法可以求解：
$$(e^{\int p(x) \rm dx}y)'=e^{\int p(x)\rm dx}(p(x)y+y')=e^{\int p(x)\rm dx} q(x)$$
两边积分：
$$e^{\int p(x)\rm dx}y=\int e^{\int p(x) \rm dx}q(x)\rm dx$$

> [!warning] 需要初始条件/边界条件
> 微分方程需要多个初始条件 or 边界条件 才能求解。

代入可以解得上一节微分方程的解为：

$$
V(t)=(1 - \exp(-t/c_Mr_M))i_Mr_M
$$
记 $\tau = c_Mr_M$ 为膜时间常数，就得到了：
$$
V(t)=(1-\exp(-t/\tau))i_Mr_M
$$

> [!tip] 膜时间常数
> $$
> \tau = c_Mr_M
> $$
## 细胞的主动电学性质

单个细胞的**主动**电学性质

1. **离子通道**——细胞内电压对外界变化的响应来自于各种类型的离子通道。尤其是 **电压门控离子通道**。研究它们的种类、结构、及其对电压等条件的响应。

2. 描述细胞电压和离子通道动态的 **微分方程组**——经典的 **Hodgkin-Huxley 方程** 及 简化的 **Morris-Lecar 模型**。
3. **树突** 的 主动电学性质

### 离子电导和离子通道

前面提及，膜电位的改变基本
### 微分方程组：Hodgkin-Huxley 方程，Morris-Lecar 方程

> [!IMPORTANT] Hodgkin-Huxley 方程：
>
> $$
> \begin{align}
> c_M D_tV&=-g_{Na}m^3h(V-E_{Na})-g_Kn^4(V-E_K)-g_L(V-E_L)\\
> D_tn&=\alpha_n(V)(1-n)-\beta_n(V)\\
> D_tm&=\alpha_m(V)(1-m)-\beta_m(V)
> \\
> D_th&=\alpha_h(V)(1-h)-\beta_h(V)
> \end{align}
> $$

> [!important] Morris-Lecar 模型：
>
> $$
> \begin{align}
> c_MD_tV &= I_{app}-g_L(V-E_L)-g_K n (V-E_K)-g_{Ca}m_{\infty}(V)(V-E_{Ca})\\
> &=I_{app}-I_{ion}(V,n)\\
> D_tn&=\phi(n_{\infty}(V)-n)/\tau_n(V)
> \end{align}
> $$

### 数值方法入门

> [!question] 用数值方法求解 Hodgkin-Huxley 方程。

> [!IMPORTANT] Hodgkin-Huxley 方程：
>
> $$
> \begin{align}
> c_M D_tV&=-g_{Na}m^3h(V-E_{Na})-g_Kn^4(V-E_K)-g_L(V-E_L)\\
> D_tn&=\alpha_n(V)(1-n)-\beta_n(V)\\
> D_tm&=\alpha_m(V)(1-m)-\beta_m(V)
> \\
> D_th&=\alpha_h(V)(1-h)-\beta_h(V)
> \end{align}
> $$

其中

$$
\begin{cases}
\alpha_n(V)=0.01(V+55)/(1-\exp(-(V+55)/10))
\\
\beta_n(V)=0.125\exp(-(V+65)/80)
\\
\alpha_m=0.1(V+40)/(1-\exp(-(V+40)/10))\\
\beta_m=4\exp(-(V+65)/18)\\
\alpha_h=0.07\exp(-(V+65)/20)
\\
\beta_h=1/(1+\exp(-(V+35)/10))
\end{cases}
$$

用 `Mathematica` 实现：

```mathematica
\[Alpha]n[V_] := 0.01 (10 - (V + 65))/(Exp[(10 - (V + 65))/10] - 1);
\[Beta]n[V_] := 0.125 Exp[-(V + 65)/80];
\[Alpha]m[V_] := 0.1 (25 - (V + 65))/(Exp[(25 - (V + 65))/10] - 1);
\[Beta]m[V_] := 4 Exp[-(V + 65)/18];
\[Alpha]h[V_] := 0.07 Exp[-(V + 65)/20];
\[Beta]h[V_] := 1/(Exp[(30 - (V + 65))/10] + 1);
cm = 1;
gk = 36;
gna = 120;
gl = 0.3;
ek = -77;
ena = 50;
el = -54.5;
I0 = 3;
eqn1 = cm V'[t] + gk n[t]^4 (V[t] - ek) +
    gna m[t]^3 h[t] (V[t] - ena) + gl (V[t] - el) - I0 == 0;
eqn2 = n'[t] == \[Alpha]n[V[t]] (1 - n[t]) - \[Beta]n[V[t]] n[t];
eqn3 = m'[t] == \[Alpha]m[V[t]] (1 - m[t]) - \[Beta]m[V[t]] m[t];
eqn4 = h'[t] == \[Alpha]h[V[t]] (1 - h[t]) - \[Beta]h[V[t]] h[t];
eqn5 = {V[0] == -70, m[0] == 0.05, h[0] == 0.54, n[0] == 0.34};
nds = NDSolve[{eqn1, eqn2, eqn3, eqn4, eqn5}, {V, m, n, h}, {t, 0,
    60}];
Plot[V[t] /. nds, {t, 0, 60}, PlotRange -> All, AxesLabel -> {t, V[t]}]
Plot[n[t] /. nds, {t, 0, 60}, PlotRange -> All, AxesLabel -> {t, n[t]}]
Plot[m[t] /. nds, {t, 0, 60}, PlotRange -> All, AxesLabel -> {t, m[t]}]
Plot[h[t] /. nds, {t, 0, 60}, PlotRange -> All,
 AxesLabel -> {t, h[t]}]
```

得到注入电流为 $3\rm \mu A/cm^2$ 的时候，膜电位 ($\rm mV$) 随时间的变化：

   <img src="C:\Users\c13rr\AppData\Roaming\Typora\typora-user-images\image-20240808134556185.png" alt="image-20240808134556185" style="zoom:50%;" />

(各种量的单位：$\rm \mu F/cm^2,mS/cm^2,mV,ms,V/s,\mu A/cm^2$).
### 动力系统入门
#### Morris-Lecar Model 的动力系统分析

> [!important] Morris-Lecar 模型：
>
> $$
> \begin{align}
> c_MD_tV &= I_{app}-g_L(V-E_L)-g_K n (V-E_K)-g_{Ca}m_{\infty}(V)(V-E_{Ca})\\
> &=I_{app}-I_{ion}(V,n)\\
> &=c_Mf(V,n)\\
> D_tn&=\phi(n_{\infty}(V)-n)/\tau_n(V)\\
> &=g(V,n)
> \end{align}
> $$

其中

$$
\begin{align}
m_{\infty}(V)&=\frac12(1+\tanh((V-V1)/V2))\\
\tau_n(V)&=1/\cosh((V-V_3)/(2V_4))\\
n_{\infty}(V)&=\frac12(1+tanh((V-V_3)/V4))
\end{align}
$$

用 `Mathematica` 绘制 V-n 相平面同时数值求解 V(t):

```Mathematica
phi = 0.04;
gca = 4.4;
v3 = 2;
v4 = 30;
eca = 120;
ek = -84;
el = -60;
gk = 8;
gl = 2;
v1 = -1.2;
v2 = 18;
cm = 20;
minfty[v_] := 1/2 (1 + Tanh@((v - v1)/v2));
taun[v_] := 1/Cosh@((v - v3)/(2 v4));
ninfty[v_] := 1/2  (1 + Tanh@((v - v3)/v4));
f[v_, n_] := (iapp - gl (v - el) - gca minfty[v] (v - eca) - 
     gk n (v - ek))/cm;
g[v_, n_] := phi (ninfty[v] - n)/taun[v];

sol = ParametricNDSolveValue[{v'[t] == f[v[t], n[t]], 
    n'[t] == g[v[t], n[t]], v[0] == v0, n[0] == n0}, {v, n}, {t, 0, 
    1000}, {iapp, v0, n0}];
Manipulate[{Dynamic[
   Show[ParametricPlot[
     Evaluate[{sol[#1, #2, #3][[1]][t], sol[#1, #2, #3][[2]][t]} &[
       Iapp, V0, N0]], {t, 0, T0}, PlotStyle -> Red], 
    ContourPlot[{0 == 
       Iapp - gl (v - el) - gca minfty[v] (v - eca) - gk n (v - ek), 
      0 == phi (ninfty[v] - n)/taun[v]}, {v, -70, 40}, {n, -0.2, 1}], 
    PlotRange -> Full, AspectRatio -> 1, ImageSize -> Large, 
    AxesOrigin -> {0, 0}]], 
  Dynamic[Plot[sol[#1, #2, #3][[1]][t] & [Iapp, V0, N0], {t, 0, T0}, 
    PlotRange -> Full, ImageSize -> Large]]}, {Iapp, 0, 
  500}, {V0, -70, 40}, {N0, 0, 1}, {T0, 1, 400}]
```

这就是我们得到的结果：

- 左图是 V-n 相平面。其中蓝色的曲线是 V'(t) 的零值线，黄色的曲线是 n'(t) 的零值线。红色的曲线则是一个给定初始条件下的 V-n 相平面动态。
- 右图是同样的初始条件下的 t-V(t) 曲线。
- 通过调整各个参数，我们可以找到不同条件下的稳定极限环和稳定不动点。
- 把 f(x),g(x) 取相反数，重复上面的操作，我们还可以找到不稳定极限环和不稳定不动点。
![](Pasted%20image%2020240818210839.png)

这些图片都是动态的，通过滑动条我们可以得到不同的结果。
对不动点进行线性化稳定性分析，其 Jacobi 矩阵为:
$$
J=\frac{D(f,g)}{D(V,n)}=
\begin{pmatrix}
D_Vf&D_nf\\
D_Vg&D_ng
\end{pmatrix}
$$
在研究的范围内 $\det(J)>0$ 恒成立,这保证了不动点不会是一个鞍点。更进一步地说，这保证了不动点在从稳定变为不稳定的过程中会发生 Hopf分岔。

当 ${\rm tr}(J)=0$, 
```mathematica
f[v_, n_, 
   iapp_] := (iapp - gl  (v - el) - gca  minfty[v]  (v - eca) - 
     gk  n  (v - ek))/cm;
g[v_, n_] := phi  (ninfty[v] - n)/taun[v];
J = {{D[f[v, n, i], v], D[f[v, n, i], n]}, {D[g[v, n], v], 
    D[g[v, n], n]}};
tr = Tr@J;
det = Det@J;
NSolve[{f[v, n, i] == 0, g[v, n] == 0, tr == 0}, {v, n, i}, Reals]
```
解得：
```mathematica
{{v -> -25.2701, n -> 0.139673, i -> 93.8576}, {v -> 7.80066, 
  n -> 0.595491, i -> 212.019}}
```
这样我们就可以断言:

> [!tip] 不动点的稳定性
> 当 $i_{app}$ 增大到 93.8576 的时候，不动点从局部稳定变为局部不稳定。当 $i_{app}$ 再增大到 212.019 的时候，不动点从局部不稳定变为局部稳定。
> 不过，我们并不能从 Jacobi 矩阵得到全局稳定性的信息。

当 ${\rm tr}^2(J)-4\det(J)=0$,
```mathematica
f[v_, n_, 
   iapp_] := (iapp - gl  (v - el) - gca  minfty[v]  (v - eca) - 
     gk  n  (v - ek))/cm;
g[v_, n_] := phi  (ninfty[v] - n)/taun[v];
J = {{D[f[v, n, i], v], D[f[v, n, i], n]}, {D[g[v, n], v], 
    D[g[v, n], n]}};
tr = Tr@J;
det = Det@J;
NSolve[{f[v, n, i] == 0, g[v, n] == 0, tr^2 - 4  det == 0}, {v, n, 
  i}, Reals]
```
其中的几组解为：
```mathematica
{v -> -17.9403, n -> 0.209266, i -> 112.958}, {v -> 2.19173,  n -> 0.503196, i -> 163.909}, {v ->17.292, n -> 0.734869, i -> 349.489}
```

# 电缆模型：被动电位的传导

## 空间常数和电缆方程

我们现在要讨论电压随空间和时间的变化，这是一个 **偏微分方程**，因为电压是位置和时间的二元函数。而且和上节不同，既然要讨论随空间的变化，就不能假定细胞内处处等势。

$$
c_M\frac{\partial V_M}{\partial t}=\frac{r}{2\rho}\frac{\partial^2V_M}{\partial x^2}-i_{跨膜}
$$

现在我们只研究细胞的被动电学性质，可以假定$i_{跨膜}=\frac{V_M}{r_M}$，化简得到

$$
\tau_M\frac{\partial V_M}{\partial t}=\lambda^2\frac{\partial^2V_M}{\partial x^2}-V_M
$$

其中 $\lambda$ 是空间常数

$$
\lambda=\sqrt{\frac{r_Mr}{2\rho}}
$$

稳态解：

$$
0=\lambda^2\frac{\partial^2V_M}{\partial x^2}-V_M
$$

> [!NOTE]
>
> 求解一个二阶常系数微分方程：

$$
V_{ss}=\frac{\lambda\rho}{\pi r^2}I_0 \exp(-\frac{x}{\lambda})
$$

输入电阻：

$$
r_{inp}=\frac{V_{ss}(0)}{i_0}=\lambda \rho=\sqrt{\frac{rr_m\rho}{2}}
$$

## 树突和电缆方程的解 / 求解偏微分方程

### 从离散的房室到连续的几何结构变化

将两个相同的各自内部等势的房室相连，我们来考察它们的电学变化

[^1]: (_Berne & Levy Physiology_, P24) 图中的 $V_m=V_{in}-V_{out}$ 代表膜电位，$G_K$ 代表膜对 $K_+$ 的电导。
[^2]: 《生物物理学：能量、信息、生命》$\S4,\S7.4,\S11.1$
[^3]: 《费曼物理学讲义》 $\S 39,40,41,43,44$
[^4]: _Fundamentals of Computational Neuroscience_
[^5]: _MATLAB® FOR NEUROSCIENTISTS_
[^6]: _Theoretical Neuroscience_
[^7]: _BIOPHYSICS OF COMPUTATION Information Processing in Single Neurons_
[^8]: 《神经科学的数学基础》
[^9]: 《微分方程、动力系统与混沌导论》
[^10]: _Ordinary Differential Equations and Dynamical Systems_
[^11]: http://be150.caltech.edu/2018/handouts/l18_phase_portraits.html
[^12]: 《非线性动力学与混沌》 Steven H.Strogatz
